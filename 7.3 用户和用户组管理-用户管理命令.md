# 7.3 用户和用户组管理-用户管理命令
## 7.3.1 用户添加命令useradd
### 1. useradd命令格式：useradd [选项] 用户名
- -u UID：手工指定用户的UID号
- -d 家目录：手工指定用户的家目录
- -c 用户说明：手工指定用户的说明
- -g 组名：手工指定用户的初始组
- -G 组名：手工指定用户的附加组
- -s shell：手工指定用户的登录shell，默认是/bin/bash

### 2. 添加默认用户
![](/Linux-Learning-Note/图片/QQ截图20220405135637.png)

### 3. 指定选项添加用户
- useradd -u 550 -G root,bin -d /home/kamp1 -c "test user" -s /bin/bash sc

### 4. 用户默认值文件
- /etc/default/useradd
  - GROUP=100：用户默认组
  - HOME=/home：用户家目录
  - INACTIVE=-1：密码过期宽限天数
  - EXPIRE=：密码失效时间
  - SHELL=/bin/bash：默认shell
  - SKEL=/etc/skel：模板目录
  - CREATE_MAIL_SPOOL=yes：是否建立邮箱
- /etc/login.defs
  - PASS_MAX_DAYS 99999：密码有效期
  - PASS_MIN_DAYS 0：密码修改间隔
  - PASS_MIN_LEN 5：密码最小5位
  - PASS_WARN_AGE 7：密码到期警告
  - UID_MIN 500：最小和最大UID范围
  - GID_MAX 60000
  - ENCRYPT_METHOD SHA512：加密模式

## 7.3.2 修改用户密码passwd
### 1. passwd命令格式：passwd [选项] 用户名
- 选项：
  - -S：查询用户密码的密码状态，仅root用户可用
  - -l：暂时锁定用户，仅root用户可用
  - -u：解锁用户，仅root用户可用
  - --stdin：可以通过管道符输出的数据作为用户的密码
- 如果普通用户改自己的密码，直接passwd即可

### 2. 锁定用户和解锁用户
- passwd -l lamp
- passwd -u lamp

### 3. 使用字符串作为用户的密码
- echo "123" | passwd --sdin lamp

## 7.3.3 修改用户信息usermod，修改用户密码状态chage
### 1. 修改用户信息usermod：usermod [选项] 用户名
- 选项
  - usermod -c "test user" lamp：修改用户的说明
  - usermod -G root lamp：把lamp用户加入root组
  - usermod -L lamp：锁定用户
  - usermod -U lamp：解锁用户

### 2. 修改用户密码状态chage：chage [选项] 用户名
- 选项：
  - -l：列出用户的详细密码状态
  - -d 日期：修改密码最后一次更改日期(shadow3字段)
  - -m 天数：两次密码修改间隔(4字段)
  - -M 天数：密码有效期(5字段)
  - -W 天数：密码过期前警告天数(6字段)
  - -I 天数：密码过后宽限天数(7字段)
  - -E 天数：账号失效时间(8字段)
- chage -d 0 lamp：这个命令其实是把密码修改日期归0了(shadow第3字段)，这样用户一登陆就要修改密码

## 7.3.4 删除用户userdel，用户切换命令su
### 1. 删除用户userdel：userdel [-r] 用户名
- 选项：
  - -r：删除用户的同时删除用户家目录
- 手工删除用户：
  - vi /etc/passwd
  - vi /etc/shadow
  - vi /etc/group
  - vi /etc/gshadow
  - rm -rf /var/spool/mail/lamp
  - rm -rf /home/lamp
  - rm -rf /etc/skel

### 2. 查看用户ID：id 用户名
### 3. 切换用户身份su：su [选项] 用户名
- 选项：
  - **-：选项只是用“-”代表连带用户的环境变量一起切换**
  - -c 命令：仅执行一次命令，而不切换用户身份
- su - root：切换成root
- su - root -c "useradd user3"：不切换成root，但是执行useradd命令添加user3用户